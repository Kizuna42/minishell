# ğŸš Minishell - Simple bash Shell Recreation

### ğŸ¯ å®Ÿè£…ç¯„å›²

- **ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ**: å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œã¨ PATH è§£æ±º
- **ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚³ãƒãƒ³ãƒ‰**: `echo`, `cd`, `pwd`, `export`, `unset`, `env`, `exit`
- **ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³**: ã‚³ãƒãƒ³ãƒ‰é–“ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ (`|`)
- **ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³**: å…¥åŠ›/å‡ºåŠ›ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ (`<`, `>`, `>>`)
- **ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: è¤‡æ•°è¡Œå…¥åŠ› (`<<`)
- **ç’°å¢ƒå¤‰æ•°**: å¤‰æ•°ã®å±•é–‹ã¨ç®¡ç† (`$VAR`)
- **ã‚¯ã‚©ãƒ¼ãƒˆå‡¦ç†**: ã‚·ãƒ³ã‚°ãƒ«ãƒ»ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆå†…ã®æ–‡å­—åˆ—å‡¦ç†
- **ã‚·ã‚°ãƒŠãƒ«å‡¦ç†**: `Ctrl+C`, `Ctrl+D`, `Ctrl+\`
- **è«–ç†æ¼”ç®—å­** (bonus): `&&`, `||`, `;`
- **ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰** (bonus): `*` ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°

---

## ğŸš€ å‹•ä½œã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ»ä¾‹

åŸºæœ¬çš„ãªã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œï¼š

```bash
minishell$ ls -la
total 16
drwxr-xr-x  4 kizuna kizuna  128 Jan 25 20:00 .
drwxr-xr-x  3 kizuna kizuna   96 Jan 25 19:00 ..
-rw-r--r--  1 kizuna kizuna 1234 Jan 25 20:00 README.md
-rw-r--r--  1 kizuna kizuna 4567 Jan 25 20:00 Makefile
```

ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¨ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ï¼š

```bash
minishell$ ls | grep .c > output.txt
minishell$ cat output.txt
main.c
parser.c
executor.c
```

ç’°å¢ƒå¤‰æ•°ã®å±•é–‹ï¼š

```bash
minishell$ echo "Hello $USER, your home is $HOME"
Hello kizuna, your home is /Users/kizuna
```

ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼š

```bash
minishell$ cat << EOF
> This is a
> multi-line
> input
> EOF
This is a
multi-line
input
```

---

## âš™ï¸ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ–¹æ³•

### ãƒ“ãƒ«ãƒ‰æ–¹æ³•

```bash
# åŸºæœ¬ç‰ˆã®ãƒ“ãƒ«ãƒ‰
make

# ãƒœãƒ¼ãƒŠã‚¹æ©Ÿèƒ½ä»˜ããƒ“ãƒ«ãƒ‰
make bonus

# ã‚¯ãƒªãƒ¼ãƒ³ãƒ“ãƒ«ãƒ‰
make fclean && make
```

### ãƒ†ã‚¹ãƒˆæ–¹æ³•

```bash
# åŸºæœ¬çš„ãªå‹•ä½œç¢ºèª
./minishell

# ãƒœãƒ¼ãƒŠã‚¹ç‰ˆã®å‹•ä½œç¢ºèª
./minishell_bonus

# Valgrindã§ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯æ¤œæŸ»
valgrind --leak-check=full ./minishell
```

---

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### èµ·å‹•æ–¹æ³•

```bash
./minishell
```

ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ `minishell$ ` ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã€é€šå¸¸ã® bash ã¨åŒæ§˜ã«ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã§ãã¾ã™ã€‚

### ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚³ãƒãƒ³ãƒ‰

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜                              | ä½¿ç”¨ä¾‹               |
| -------- | --------------------------------- | -------------------- |
| `echo`   | æ–‡å­—åˆ—ã‚’å‡ºåŠ› (`-n`ã‚ªãƒ—ã‚·ãƒ§ãƒ³å¯¾å¿œ) | `echo "Hello World"` |
| `cd`     | ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå¤‰æ›´                  | `cd /path/to/dir`    |
| `pwd`    | ç¾åœ¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¡¨ç¤º          | `pwd`                |
| `export` | ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šãƒ»è¡¨ç¤º              | `export VAR=value`   |
| `unset`  | ç’°å¢ƒå¤‰æ•°ã‚’å‰Šé™¤                    | `unset VAR`          |
| `env`    | ç’°å¢ƒå¤‰æ•°ä¸€è¦§ã‚’è¡¨ç¤º                | `env`                |
| `exit`   | ã‚·ã‚§ãƒ«ã‚’çµ‚äº†                      | `exit [code]`        |

### ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãƒ»ãƒ‘ã‚¤ãƒ—ã®è¨˜æ³•

```bash
# å‡ºåŠ›ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
command > file.txt

# è¿½è¨˜ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
command >> file.txt

# å…¥åŠ›ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
command < input.txt

# ãƒ’ã‚¢ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
command << DELIMITER

# ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
command1 | command2 | command3
```

### ãƒœãƒ¼ãƒŠã‚¹æ©Ÿèƒ½

```bash
# è«–ç†æ¼”ç®—å­
command1 && command2    # command1ãŒæˆåŠŸã—ãŸå ´åˆã®ã¿command2ã‚’å®Ÿè¡Œ
command1 || command2    # command1ãŒå¤±æ•—ã—ãŸå ´åˆã®ã¿command2ã‚’å®Ÿè¡Œ
command1 ; command2     # command1ã®çµæœã«é–¢ä¿‚ãªãcommand2ã‚’å®Ÿè¡Œ

# ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰
ls *.c                  # .cã§çµ‚ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤º
echo test_*             # test_ã§å§‹ã¾ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«/ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¡¨ç¤º
```

---

## ğŸ—‚ï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
minishell/
â”œâ”€â”€ Makefile                    # ãƒ“ãƒ«ãƒ‰è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ README.md                   # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆèª¬æ˜æ›¸
â”œâ”€â”€ includes/
â”‚   â””â”€â”€ minishell.h            # ãƒ¡ã‚¤ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ libft/                     # è‡ªä½œãƒ©ã‚¤ãƒ–ãƒ©ãƒª
â”‚   â”œâ”€â”€ Makefile
â”‚   â”œâ”€â”€ libft.h
â”‚   â””â”€â”€ src/                   # libfté–¢æ•°ç¾¤
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.c                 # ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ main_utils.c           # ãƒ¡ã‚¤ãƒ³è£œåŠ©é–¢æ•°
â”‚   â”œâ”€â”€ lexer/                 # å­—å¥è§£æãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”‚   â”œâ”€â”€ lexer.c           # ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼
â”‚   â”‚   â”œâ”€â”€ lexer_utils.c     # å­—å¥è§£æè£œåŠ©
â”‚   â”‚   â”œâ”€â”€ lexer_quote.c     # ã‚¯ã‚©ãƒ¼ãƒˆå‡¦ç†
â”‚   â”‚   â””â”€â”€ tokenizer.c       # ãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆ
â”‚   â”œâ”€â”€ parser/               # æ§‹æ–‡è§£æãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”‚   â”œâ”€â”€ parser.c          # ASTæ§‹ç¯‰
â”‚   â”‚   â”œâ”€â”€ parser_*.c        # å„ç¨®ãƒ‘ãƒ¼ã‚µãƒ¼æ©Ÿèƒ½
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ executor/             # å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”‚   â”œâ”€â”€ executor.c        # ãƒ¡ã‚¤ãƒ³å®Ÿè¡Œéƒ¨
â”‚   â”‚   â”œâ”€â”€ builtin*.c        # ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã‚³ãƒãƒ³ãƒ‰
â”‚   â”‚   â”œâ”€â”€ pipes.c           # ãƒ‘ã‚¤ãƒ—å‡¦ç†
â”‚   â”‚   â”œâ”€â”€ redirections.c    # ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå‡¦ç†
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ utils/                # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”‚   â”œâ”€â”€ env_*.c           # ç’°å¢ƒå¤‰æ•°ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ expand_*.c        # å¤‰æ•°å±•é–‹
â”‚   â”‚   â”œâ”€â”€ wildcard*.c       # ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰å‡¦ç†
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ bonus/                # ãƒœãƒ¼ãƒŠã‚¹æ©Ÿèƒ½
â”‚       â”œâ”€â”€ logical_ops.c     # è«–ç†æ¼”ç®—å­
â”‚       â””â”€â”€ wildcards.c       # ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰æ‹¡å¼µ
```

### ä¸»è¦ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è²¬ä»»

1. **Lexer (å­—å¥è§£æ)**

   - å…¥åŠ›æ–‡å­—åˆ—ã‚’ãƒˆãƒ¼ã‚¯ãƒ³ã«åˆ†å‰²
   - ã‚¯ã‚©ãƒ¼ãƒˆå‡¦ç†ã€ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—æ–‡å­—ã®å‡¦ç†
   - æ¼”ç®—å­ã¨ã‚³ãƒãƒ³ãƒ‰ã®è­˜åˆ¥

2. **Parser (æ§‹æ–‡è§£æ)**

   - ãƒˆãƒ¼ã‚¯ãƒ³åˆ—ã‹ã‚‰æŠ½è±¡æ§‹æ–‡æœ¨(AST)ã‚’æ§‹ç¯‰
   - æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ã®æ¤œå‡º
   - å„ªå…ˆåº¦ã«åŸºã¥ãæ¼”ç®—å­è§£æ

3. **Executor (å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³)**

   - AST ã‚’èµ°æŸ»ã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ
   - ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç† (fork/exec)
   - ãƒ‘ã‚¤ãƒ—ãƒ»ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã®å‡¦ç†

4. **Utils (ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£)**
   - ç’°å¢ƒå¤‰æ•°ã®ç®¡ç†
   - å¤‰æ•°å±•é–‹ã¨ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰å‡¦ç†
   - ã‚¨ãƒ©ãƒ¼å‡¦ç†ã¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

---

## ğŸ”§ å®Ÿè£…ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆ

### AST ãƒ™ãƒ¼ã‚¹ã®æ§‹æ–‡è§£æ

Minishell ã§ã¯ã€å…¥åŠ›ã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’ä»¥ä¸‹ã®æµã‚Œã§å‡¦ç†ã—ã¾ã™ï¼š

```
å…¥åŠ›æ–‡å­—åˆ— â†’ Lexer â†’ ãƒˆãƒ¼ã‚¯ãƒ³åˆ— â†’ Parser â†’ AST â†’ Executor â†’ å®Ÿè¡Œ
```

ã“ã®è¨­è¨ˆã«ã‚ˆã‚Šã€è¤‡é›‘ãªã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚‚æ§‹é€ åŒ–ã—ã¦å‡¦ç†ã§ãã¾ã™ã€‚

### ãƒ¡ãƒ¢ãƒªç®¡ç†ã¨ã‚¨ãƒ©ãƒ¼å‡¦ç†

- **å³å¯†ãªãƒ¡ãƒ¢ãƒªç®¡ç†**: å…¨ã¦ã®å‹•çš„ãƒ¡ãƒ¢ãƒªã‚’é©åˆ‡ã«è§£æ”¾
- **ãƒªãƒ¼ã‚¯ãƒ•ãƒªãƒ¼**: Valgrind ã§ã®ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ 0 ã‚’ä¿è¨¼
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: POSIX æº–æ‹ ã®ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

### ã‚·ã‚°ãƒŠãƒ«å‡¦ç†

```c
// ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚·ã‚°ãƒŠãƒ«çŠ¶æ…‹ç®¡ç†
volatile sig_atomic_t g_signal_status = 0;

// Ctrl+C, Ctrl+\, Ctrl+Dã®é©åˆ‡ãªå‡¦ç†
void setup_signal_handlers(void);
```

### fork/exec ãƒ¢ãƒ‡ãƒ«

å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œã¯æ¨™æº–çš„ãª Unix ãƒ—ãƒ­ã‚»ã‚¹ãƒ¢ãƒ‡ãƒ«ã«å¾“ã„ã¾ã™ï¼š

```c
pid_t pid = fork();
if (pid == 0) {
    execve(path, args, envp);  // å­ãƒ—ãƒ­ã‚»ã‚¹ã§å¤–éƒ¨ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œ
} else {
    waitpid(pid, &status, 0);  // è¦ªãƒ—ãƒ­ã‚»ã‚¹ã§å®Œäº†å¾…æ©Ÿ
}
```

---

## ğŸ“š å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç†è§£ã™ã‚‹ãŸã‚ã«æ¨å¥¨ã•ã‚Œã‚‹å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹ï¼š

### Unix/Linux ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°

- **ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒ¼ãƒ«**: fork, exec, wait, pipe, dup2
- **ã‚·ã‚°ãƒŠãƒ«å‡¦ç†**: signal, sigaction
- **ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ**: open, read, write, close

### ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ—ãƒªã‚¿ãƒ¼ç†è«–

- **å­—å¥è§£æ**: ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã®å®Ÿè£…
- **æ§‹æ–‡è§£æ**: å†å¸°ä¸‹é™ãƒ‘ãƒ¼ã‚µãƒ¼ã€AST æ§‹ç¯‰
- **å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³**: Tree-walking ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ—ãƒªã‚¿ãƒ¼

---
